<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>USDT Exchange</title>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js"></script>
</head>
<body>
  <h2>Buy / Sell USDT</h2>

  <form id="orderForm">
    <label>Type:</label>
    <select id="side">
      <option value="buy">Buy</option>
      <option value="sell">Sell</option>
    </select><br/><br/>

    <label>Amount (USDT):</label>
    <input type="number" id="amount" required /><br/><br/>

    <label>Network:</label>
    <select id="network">
      <option value="TRC20">TRC20</option>
      <option value="ERC20">ERC20</option>
    </select><br/><br/>

    <label>Wallet Address:</label>
    <input type="text" id="addr" required /><br/><br/>

    <label>Your WhatsApp Number:</label>
    <input type="text" id="wa" placeholder="91XXXXXXXXXX" required /><br/><br/>

    <button type="submit">Submit Order</button>
  </form>

  <p id="status"></p>

<script>
  // üîπ Firebase Config (‡§§‡•Å‡§ù‡§æ config ‡§ü‡§æ‡§ï‡§æ)
  const firebaseConfig = {
    apiKey: "YOUR_API_KEY",
    authDomain: "YOUR_PROJECT.firebaseapp.com",
    projectId: "YOUR_PROJECT",
    storageBucket: "YOUR_PROJECT.appspot.com",
    messagingSenderId: "SENDER_ID",
    appId: "APP_ID"
  };

  // üîπ Firebase Init
  const app = firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  // üîπ WhatsApp Config (‡§§‡•Å‡§ù‡§æ Token ‡§µ Phone ID ‡§ü‡§æ‡§ï‡§æ)
  const WHATSAPP_TOKEN = "YOUR_PERMANENT_ACCESS_TOKEN";
  const WHATSAPP_PHONE_ID = "YOUR_PHONE_NUMBER_ID";
  const ALERT_TO = "91XXXXXXXXXX"; // ‡§§‡•Å‡§ù‡§æ WhatsApp ‡§®‡§Ç‡§¨‡§∞

  async function sendWhatsApp(body) {
    const url = `https://graph.facebook.com/v21.0/${WHATSAPP_PHONE_ID}/messages`;
    const res = await fetch(url, {
      method: "POST",
      headers: {
        "Authorization": "Bearer " + WHATSAPP_TOKEN,
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        messaging_product: "whatsapp",
        to: ALERT_TO,
        type: "text",
        text: { body }
      })
    });
    return res.json();
  }

  // üîπ Order Form Submit
  document.getElementById("orderForm").addEventListener("submit", async (e) => {
    e.preventDefault();
    const side = document.getElementById("side").value;
    const amount = document.getElementById("amount").value;
    const network = document.getElementById("network").value;
    const addr = document.getElementById("addr").value;
    const wa = document.getElementById("wa").value;

    const order = { side, amount, network, addr, wa, createdAt: new Date() };

    try {
      // Firestore save
      await db.collection("orders").add(order);

      // WhatsApp Alert
      const msg = `üì¢ NEW USDT ORDER\nType: ${side}\nAmount: ${amount} USDT\nNetwork: ${network}\nWallet: ${addr}\nUser WA: ${wa}`;
      await sendWhatsApp(msg);

      document.getElementById("status").innerText = "‚úÖ Order placed & notification sent!";
    } catch (err) {
      console.error(err);
      document.getElementById("status").innerText = "‚ùå Error: " + err.message;
    }
  });
</script>
</body>
</html>
